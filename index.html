<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>El Secreto del Zoco de las Estrellas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- TIPOGRAF√çAS √ÅRABES / M√çSTICAS -->
  <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;600&family=Scheherazade+New:wght@700&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'El Messiri', sans-serif;
    }

    h1, h2 {
      font-family: 'Scheherazade New', serif;
      letter-spacing: 0.5px;
    }

    body {
      background: radial-gradient(circle at top, #143a52 0%, #120c16 50%, #050308 100%);
      color: #fdf7e7;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .game-container {
      width: 100%;
      max-width: 480px;
      padding: 16px;
    }

    .card {
      background: rgba(14, 9, 20, 0.92);
      border-radius: 18px;
      padding: 20px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 215, 0, 0.25);
      position: relative;
      overflow: hidden;
    }

    .screen { display: none; }
    .screen.active { display: block; }

    .zellige-line {
      height: 8px;
      width: 100%;
      margin: 10px 0 16px;
      background-image:
        linear-gradient(45deg, #006d77 25%, transparent 25%),
        linear-gradient(-45deg, #e29578 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #ffddd2 75%),
        linear-gradient(-45deg, transparent 75%, #83c5be 75%);
      background-size: 14px 14px;
    }

    .btn {
      margin-top: 14px;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      font-size: 1.1rem;
      cursor: pointer;
      background: linear-gradient(135deg, #ffce54, #f6a623);
      color: #3a1800;
      font-weight: 600;
      width: 100%;
      box-shadow: 0 6px 16px rgba(0,0,0,0.45);
    }

    .small {
      font-size: 0.9rem;
      opacity: 0.9;
      text-align: center;
    }

    /* Caja cerrada */
    .box-locked {
      margin: 16px auto;
      width: 140px;
      height: 80px;
      border-radius: 8px;
      background: linear-gradient(135deg, #b08d57, #f0c878);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.5);
    }

    .locks {
      display: flex;
      justify-content: center;
      gap: 8px;
    }

    .lock {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #3b2203;
      background: rgba(255,255,255,0.1);
    }

    .lock.open {
      background: #8bc34a;
      box-shadow: 0 0 8px rgba(139,195,74,0.8);
    }

    /* Prueba 1 */
    .objects-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 12px;
    }

    .object-card {
      padding: 16px;
      border-radius: 12px;
      background: rgba(34,23,43,0.85);
      cursor: pointer;
      border: 1px solid rgba(255,215,0,0.2);
      text-align: center;
      transition: 0.2s;
    }

    .object-card span {
      font-size: 2rem;
      display: block;
      margin-bottom: 6px;
    }

    /* Prueba 2 */
    .colors-row {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }

    .color-box {
      flex: 1;
      height: 70px;
      border-radius: 12px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.4);
      padding-bottom: 6px;
      font-size: 0.9rem;
    }

    .color-azul { background: linear-gradient(135deg,#1a4f7a,#1e88e5); }
    .color-ocre { background: linear-gradient(135deg,#bf8b3b,#ffb74d); }
    .color-verde { background: linear-gradient(135deg,#00796b,#26a69a); }

    /* Prueba 3 */
    .desert-area {
      height: 190px;
      border-radius: 18px;
      background: linear-gradient(to top, #c96f28 0%, #f4a261 40%, #26163b 40%, #1d2a3a 100%);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255,215,0,0.25);
    }

    .stars {
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(255,255,255,0.8) 0, transparent 40%),
        radial-gradient(circle at 80% 30%, rgba(255,255,255,0.75) 0, transparent 40%),
        radial-gradient(circle at 60% 60%, rgba(255,255,255,0.7) 0, transparent 40%);
      opacity: .45;
    }

    .dune {
      position: absolute;
      bottom: 0;
      width: 200%;
      height: 60px;
      background: linear-gradient(to right,#d38b3c,#e9c46a,#d38b3c);
      opacity: 0.7;
      border-radius: 50% 50% 0 0;
    }

    .light {
      position: absolute;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: radial-gradient(circle,#ffe082 0%,#ffc107 40%,transparent 70%);
      box-shadow: 0 0 12px rgba(255,241,118,0.9);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: .9rem;
      font-weight: bold;
    }

    /* FINAL: Caja animada */
    .final-box {
      position: relative;
      max-width: 260px;
      margin: 20px auto;
      padding: 16px;
      border-radius: 18px;
      background: linear-gradient(135deg, #f9f0d7, #f5e1a4);
      color: #3b2714;
      text-align: center;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
      overflow: hidden;
      transform: scale(0.9);
      opacity: 0;
      animation: box-appear 1.2s ease forwards;
    }

    @keyframes box-appear {
      0% { transform: scale(0.7); opacity: 0; filter: brightness(0.5); }
      70% { transform: scale(1.03); opacity: 1; filter: brightness(1.4); }
      100% { transform: scale(1); opacity: 1; filter: brightness(1); }
    }

    .lid {
      position: absolute;
      width: 120%;
      height: 50%;
      top: 0;
      left: -10%;
      background: linear-gradient(135deg, #e4c88f, #c19a56);
      border-bottom: 3px solid #7a5a32;
      border-radius: 14px;
      transform-origin: top;
      transform: rotateX(0deg);
      animation: lid-open 1.8s ease forwards;
      animation-delay: 0.4s;
    }

    @keyframes lid-open {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(75deg) translateY(-8px); }
    }

    /* TARJETA QUE SE ELEVA */
    .card-fly {
      position: absolute;
      width: 180px;
      height: 110px;
      left: 50%;
      top: 55%;
      transform: translateX(-50%) translateY(20px) scale(0.9);
      background: #ffffff;
      border-radius: 10px;
      border: 3px solid #d4a74d;
      box-shadow: 0 6px 14px rgba(0,0,0,0.4);
      text-align: center;
      padding-top: 18px;
      font-size: 1.1rem;
      font-weight: 600;
      color: #5a4318;
      opacity: 0;
      z-index: 10;

      animation: card-rise 2s ease-out forwards;
      animation-delay: 1.7s;
    }

    @keyframes card-rise {
      0% {
        opacity: 0;
        transform: translateX(-50%) translateY(40px) scale(0.7);
      }
      60% {
        opacity: 1;
        transform: translateX(-50%) translateY(-10px) scale(1);
      }
      100% {
        opacity: 1;
        transform: translateX(-50%) translateY(-20px) scale(1);
      }
    }

    .card-fly::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg,
        rgba(255,255,255,0.0) 0%,
        rgba(255,255,255,0.4) 40%,
        rgba(255,255,255,0.0) 80%
      );
      border-radius: 10px;
      opacity: 0;
      animation: card-shine 2s ease-in-out forwards;
      animation-delay: 2.3s;
    }

    @keyframes card-shine {
      0% { opacity: 0; }
      50% { opacity: 0.7; }
      100% { opacity: 0.15; }
    }

    /* Brillo global */
    .reveal-glow {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at center,
        rgba(255, 220, 120, 0.25),
        rgba(255, 220, 120, 0.15),
        transparent 70%
      );
      pointer-events: none;
      opacity: 0;
      animation: glow-reveal 2.8s ease forwards;
    }

    @keyframes glow-reveal {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0.3; }
    }

    .camel-container {
      margin-top: 20px;
      height: 80px;
      overflow: hidden;
      position: relative;
    }

    .camel {
      position: absolute;
      left: -80px;
      bottom: 0;
      font-size: 3.2rem;
      animation: camel-walk 7s linear forwards, camel-bob 1s ease-in-out infinite;
    }

    @keyframes camel-walk {
      0% { transform: translateX(0); }
      100% { transform: translateX(140vw); }
    }

    @keyframes camel-bob {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }
  </style>
</head>

<body>
  <div class="game-container">
    <div class="card">

      <!-- INTRO -->
      <div id="screen-intro" class="screen active">
        <h1>El Secreto del Zoco de las Estrellas</h1>
        <div class="zellige-line"></div>
        <p class="small">En la noche de tu cumplea√±os, un mensaje aparece sin explicaci√≥n‚Ä¶</p>
        <p class="small" style="font-style:italic;">
          ‚ÄúQuien siga la luz del desierto encontrar√° un regalo reservado para su destino.‚Äù
        </p>
        <button class="btn" onclick="goTo('screen-story')">Comenzar</button>
      </div>

      <!-- HISTORIA -->
      <div id="screen-story" class="screen">
        <h2>El Mercader de las Estrellas</h2>
        <div class="zellige-line"></div>
        <p class="small">
          Abres los ojos y est√°s en un zoco marroqu√≠. El aire huele a especias. Un mercader de barba blanca
          te mira y sonr√≠e.
        </p>
        <p class="small" style="font-style:italic; margin-top:8px;">
          ‚ÄúTe estaba esperando. Esta caja contiene aquello que tu alma anhela.
          Pero su secreto solo se revela a quien supera tres pruebas antiguas‚Ä¶‚Äù
        </p>

        <div class="box-locked"></div>
        <div class="locks">
          <div id="lock1" class="lock"></div>
          <div id="lock2" class="lock"></div>
          <div id="lock3" class="lock"></div>
        </div>

        <button class="btn" onclick="goTo('screen-test1')">Primera prueba</button>
      </div>

      <!-- PRUEBA 1 -->
      <div id="screen-test1" class="screen">
        <h2>Prueba 1: El Zoco de los Ecos</h2>
        <div class="zellige-line"></div>
        <p class="small"><strong>Instrucciones:</strong> Elige uno de los objetos. El mercader dice:</p>
        <p class="small" style="font-style:italic;">‚ÄúLos objetos hablan. Escoge aquel cuyo eco resuene contigo.‚Äù</p>

        <div class="objects-grid">
          <div class="object-card" onclick="test1()">
            <span>üçµ</span><p>Tetera de menta</p>
          </div>
          <div class="object-card" onclick="test1()">
            <span>üïå</span><p>Minarete</p>
          </div>
          <div class="object-card" onclick="test1()">
            <span>üõ†Ô∏è</span><p>Artesano</p>
          </div>
          <div class="object-card" onclick="test1()">
            <span>üê™</span><p>Camello</p>
          </div>
        </div>

        <p id="msg1" class="small"></p>
      </div>

      <!-- PRUEBA 2 -->
      <div id="screen-test2" class="screen">
        <h2>Prueba 2: Los Colores de Marruecos</h2>
        <div class="zellige-line"></div>

        <p class="small"><strong>Instrucciones:</strong> Toca cada color una vez.</p>
        <p class="small" style="font-style:italic;">
          ‚ÄúCada color cuenta una historia. Juntos revelan caminos antiguos‚Ä¶‚Äù
        </p>

        <div class="colors-row">
          <div class="color-box color-azul" data-color="azul" onclick="colorClick(this)">Azul Majorelle</div>
          <div class="color-box color-ocre" data-color="ocre" onclick="colorClick(this)">Ocre</div>
          <div class="color-box color-verde" data-color="verde" onclick="colorClick(this)">Zellige verde</div>
        </div>

        <p id="msg2" class="small"></p>
      </div>

      <!-- PRUEBA 3 -->
      <div id="screen-test3" class="screen">
        <h2>Prueba 3: Las Dunas del Sue√±o</h2>
        <div class="zellige-line"></div>
        <p class="small"><strong>Instrucciones:</strong> Toca la luz 3 veces.</p>
        <p class="small" style="font-style:italic;">
          ‚ÄúSigue la luz, como lo hacen los viajeros del desierto‚Ä¶‚Äù
        </p>

        <div id="desert-area" class="desert-area">
          <div class="stars"></div>
          <div class="dune"></div>
          <div id="light" class="light" onclick="lightClick()">‚òÖ</div>
        </div>

        <p id="msg3" class="small"></p>
      </div>

      <!-- FINAL -->
      <div id="screen-final" class="screen">
        <div class="reveal-glow"></div>

        <h2>La Caja se Abre</h2>
        <div class="zellige-line"></div>

        <p class="small">Un destello dorado inunda el aire‚Ä¶</p>

        <div class="final-box">
          <div class="lid"></div>

          <!-- TARJETA F√çSICA QUE SE ELEVA -->
          <div class="card-fly">Viaje a<br>Marruecos</div>

          <div class="final-card-text">
            <h2 style="margin-top:20px;">üéâ ¬°Feliz cumplea√±os! üéâ</h2>
            <p>Dentro de la caja encuentras una sorpresa:</p>
            <p style="font-weight:700; margin-top:6px; font-size:1.3rem;">
              üß≥ Un viaje a Marruecos üß≥
            </p>
            <p class="small" style="font-style:italic;">
              ‚ÄúQuien sigue la luz del desierto merece descubrir nuevos horizontes.‚Äù
            </p>
          </div>
        </div>

        <div class="camel-container">
          <div class="camel">üê™</div>
        </div>

        <button class="btn" onclick="restart()">Ver la sorpresa otra vez</button>
      </div>

    </div>
  </div>

<script>
function goTo(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const screen = document.getElementById(id);
  screen.classList.add('active');

  if(id === "screen-test3"){
    resetLightPosition();
  }

  /* Reiniciar animaciones finales */
  if(id === "screen-final"){
    const elements = [
      ".final-box", ".lid", ".reveal-glow", ".card-fly"
    ];
    elements.forEach(sel=>{
      const el = screen.querySelector(sel);
      if(el){
        el.style.animation = "none";
        void el.offsetWidth;
        el.style.animation = "";
      }
    });
  }
}

/* Prueba 1 */
function test1(){
  document.getElementById("lock1").classList.add("open");
  document.getElementById("msg1").textContent =
    "‚ÄúHas escuchado el eco del zoco‚Ä¶ donde cada sonido es una puerta.‚Äù";
  setTimeout(()=>goTo("screen-test2"),1200);
}

/* Prueba 2 */
let colors = new Set();
function colorClick(el){
  const color = el.dataset.color;
  if(!colors.has(color)){
    colors.add(color);
    el.style.opacity = .7;
  }
  if(colors.size === 3){
    document.getElementById("lock2").classList.add("open");
    document.getElementById("msg2").textContent =
      "‚ÄúLos colores hablan de patios azules, dunas doradas y mosaicos eternos‚Ä¶‚Äù";
    setTimeout(()=>goTo("screen-test3"),1200);
  } else {
    document.getElementById("msg2").textContent = "Sigue tocando colores‚Ä¶";
  }
}

/* Prueba 3 */
let lightCount = 0;
function resetLightPosition(){
  const area=document.getElementById("desert-area");
  const light=document.getElementById("light");
  const r=area.getBoundingClientRect();
  const x=Math.random()*(r.width-40)+10;
  const y=Math.random()*(r.height-40)+10;
  light.style.left=x+"px";
  light.style.top=y+"px";
}

function lightClick(){
  lightCount++;
  if(lightCount < 3){
    document.getElementById("msg3").textContent =
      "‚ÄúHas seguido la luz‚Ä¶ como lo hacen los viajeros del desierto.‚Äù";
    resetLightPosition();
  } else {
    document.getElementById("lock3").classList.add("open");
    document.getElementById("msg3").textContent =
      "‚ÄúHas cruzado las dunas‚Ä¶ solo queda revelar el destino.‚Äù";
    setTimeout(()=>goTo("screen-final"),1200);
  }
}

/* Reinicio */
function restart(){
  colors.clear();
  lightCount=0;

  document.querySelectorAll('.color-box').forEach(box => box.style.opacity = 1);
  document.querySelectorAll('.lock').forEach(lock => lock.classList.remove('open'));

  document.getElementById("msg1").textContent = "";
  document.getElementById("msg2").textContent = "";
  document.getElementById("msg3").textContent = "";

  goTo("screen-intro");
  resetLightPosition();
}

window.onload = resetLightPosition;
</script>

</body>
</html>
